<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="it">
<head>
<!-- Generated by javadoc (1.8.0_171) on Thu May 31 10:52:38 CEST 2018 -->
<title>HybridFileEncryptionStream</title>
<meta name="date" content="2018-05-31">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="HybridFileEncryptionStream";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/HybridFileEncryptionStream.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/intel/fightclub/encryption/encrypt/HybridFileEncryptionStream.html" target="_top">Frames</a></li>
<li><a href="HybridFileEncryptionStream.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.intel.fightclub.encryption.encrypt</div>
<h2 title="Class HybridFileEncryptionStream" class="title">Class HybridFileEncryptionStream</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.intel.fightclub.encryption.encrypt.HybridFileEncryptionStream</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>@NotThreadSafe
public class <span class="typeNameLabel">HybridFileEncryptionStream</span>
extends java.lang.Object</pre>
<div class="block">Streams data to a file by encrypting it and then writing it to a file. This uses a hybrid
 encryption stream where it generates a symmetric key that is used with AES to encrypt the
 data. Once data transfer has finished, then the symmetric key is encrypted using RSA and
 attached to the file.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../com/intel/fightclub/encryption/encrypt/HybridFileEncryptionStream.html#HybridFileEncryptionStream-java.lang.String-java.security.Key-">HybridFileEncryptionStream</a></span>(java.lang.String&nbsp;outputPath,
                          java.security.Key&nbsp;rsaPublicKey)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../com/intel/fightclub/encryption/encrypt/HybridFileEncryptionStream.html#HybridFileEncryptionStream-java.lang.String-com.intel.fightclub.encryption.common.keys.KeySize-java.security.Key-">HybridFileEncryptionStream</a></span>(java.lang.String&nbsp;outputPath,
                          <a href="../../../../../com/intel/fightclub/encryption/common/keys/KeySize.html" title="enum in com.intel.fightclub.encryption.common.keys">KeySize</a>&nbsp;aesKeySize,
                          java.security.Key&nbsp;rsaPublicKey)</code>
<div class="block">Constructor.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/intel/fightclub/encryption/encrypt/HybridFileEncryptionStream.html#close--">close</a></span>()</code>
<div class="block">Closes the file by writing out any remaining data in the cipher block with padding.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/intel/fightclub/encryption/encrypt/HybridFileEncryptionStream.html#encryptBytes-byte:A-">encryptBytes</a></span>(byte[]&nbsp;bytes)</code>
<div class="block">Encrypts the entire byte array and streams it to the output file.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/intel/fightclub/encryption/encrypt/HybridFileEncryptionStream.html#encryptBytes-byte:A-int-int-">encryptBytes</a></span>(byte[]&nbsp;bytes,
            int&nbsp;offset,
            int&nbsp;length)</code>
<div class="block">Encrypts the byte array starting from the provided offset and streams length bytes to the
 output file.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/intel/fightclub/encryption/encrypt/HybridFileEncryptionStream.html#encryptBytes-java.nio.ByteBuffer-">encryptBytes</a></span>(java.nio.ByteBuffer&nbsp;buffer)</code>
<div class="block">Encrypts the provided <code>ByteBuffer</code> and streams it to the output file.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/intel/fightclub/encryption/encrypt/HybridFileEncryptionStream.html#prepare-byte:A...-">prepare</a></span>(byte[]...&nbsp;hashParameters)</code>
<div class="block">Prepares the file to be encrypted.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="HybridFileEncryptionStream-java.lang.String-java.security.Key-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>HybridFileEncryptionStream</h4>
<pre>public&nbsp;HybridFileEncryptionStream(@NotNull
                                  java.lang.String&nbsp;outputPath,
                                  @NotNull
                                  java.security.Key&nbsp;rsaPublicKey)
                           throws java.io.IOException</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="HybridFileEncryptionStream-java.lang.String-com.intel.fightclub.encryption.common.keys.KeySize-java.security.Key-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>HybridFileEncryptionStream</h4>
<pre>public&nbsp;HybridFileEncryptionStream(@NotNull
                                  java.lang.String&nbsp;outputPath,
                                  @NotNull
                                  <a href="../../../../../com/intel/fightclub/encryption/common/keys/KeySize.html" title="enum in com.intel.fightclub.encryption.common.keys">KeySize</a>&nbsp;aesKeySize,
                                  @NotNull
                                  java.security.Key&nbsp;rsaPublicKey)
                           throws java.io.FileNotFoundException</pre>
<div class="block">Constructor. Prepares the output file for writing and initializes the necessary encryption
 tools. Uses the AES encryption algorithm with a 256-bit key and uses CBC mode with the
 default Sun PKCS#5 padding implementation. Also generates a 256-bit symmetric key which is
 used to generate a HMAC.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>outputPath</code> - The absolute path to the file that encrypted data will be written to.</dd>
<dd><code>rsaPublicKey</code> - The absolute path to the RSA public key file. This file must be
                     formatted with the X.509 standard.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.FileNotFoundException</code> - Thrown if the output file could not be created or if an
 existing file with that name is not writable.</dd>
<dd><code>java.lang.NullPointerException</code> - Thrown if the provided AES key size or the RSA public key is
 null.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="close--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;close()
           throws java.io.IOException</pre>
<div class="block"><p>Closes the file by writing out any remaining data in the cipher block with padding. The
 HMAC is then written to the beginning of the file. The final format of the file should
 be as follows:</p>

 <p>
     TOP_HEADER (8 bytes) || HMAC (4 bytes) || |SK_AES| (2 bytes) || SK_AES (256 bytes)
     || |SK_HMAC || SK_HMAC (256 bytes) || IV (16 bytes) || DATA (N bytes)
 </p>

 <p>
     Where...
     <ul>
         <li>|| is the concatenation operator.</li>
         <li>TOP_HEADER is 8 bytes of data spelling out "SCIPHERX" in order to help identify
             the file as being encrypted.</li>
         <li>HMAC is the key-hashed message authentication code (4 bytes plaintext)</li>
         <li>|SK_AES| is the size of SK_AES (2 bytes)</li>
         <li>SK_AES is the encrypted AES symmetric key (32 bytes ciphertext)</li>
         <li>|SK_HMAC| is the size of SK_HMAC (2 bytes)</li>
         <li>SK_HMAC is the encrypted HMAC symmetric key (32 bytes ciphertext)</li>
         <li>IV is the initialization vector (16 bytes plaintext)</li>
         <li>DATA is the encrypted data (same size as plaintext)</li>
     </ul>
 </p></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - Thrown if the file could not be closed.</dd>
</dl>
</li>
</ul>
<a name="prepare-byte:A...-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepare</h4>
<pre>public&nbsp;void&nbsp;prepare(@Nullable
                    byte[]...&nbsp;hashParameters)
             throws java.security.InvalidKeyException,
                    java.io.IOException</pre>
<div class="block"><p>Prepares the file to be encrypted. This will write the AES and HMAC symmetric keys to the
 output file in addition to the initialization vector. Space will be left at the beginning
 of the file to write out the HMAC when it has been finalized when the file is closed with
 <a href="../../../../../com/intel/fightclub/encryption/encrypt/HybridFileEncryptionStream.html#close--"><code>close()</code></a>.</p>

 <p>If this has been already called in the past, then this will delete the contents of the
 file and start from scratch.</p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>hashParameters</code> - Any additional data to add to the HMAC computation. These parameters
                       are added to the HMAC computation after the AES symmetric key and
                       IV.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - Thrown if the key used to encrypt the symmetric keys are invalid.</dd>
<dd><code>java.io.IOException</code> - Thrown if an IO error occurred when writing to the file.</dd>
</dl>
</li>
</ul>
<a name="encryptBytes-byte:A-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encryptBytes</h4>
<pre>public&nbsp;int&nbsp;encryptBytes(@NotNull
                        byte[]&nbsp;bytes,
                        int&nbsp;offset,
                        int&nbsp;length)
                 throws java.io.IOException</pre>
<div class="block">Encrypts the byte array starting from the provided offset and streams length bytes to the
 output file.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>bytes</code> - The byte array to encrypt and write to file.</dd>
<dd><code>offset</code> - Offset from the start of the byte array to start encrypting bytes.</dd>
<dd><code>length</code> - The number of bytes to encrypt and write to file</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The number of bytes written to the file. This may be less than the number of bytes
 in the input (or even 0) if the current cipher block has empty space available.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - Thrown if the <code>#prepare(byte[]...)</code> method has not been
 called prior to calling this method.</dd>
<dd><code>java.io.IOException</code> - Thrown if a IO error occurred while writing the encrypted data to the
 output file.</dd>
<dd><code>java.lang.NullPointerException</code> - Thrown if the input buffer is null.</dd>
</dl>
</li>
</ul>
<a name="encryptBytes-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encryptBytes</h4>
<pre>public&nbsp;int&nbsp;encryptBytes(@NotNull
                        byte[]&nbsp;bytes)
                 throws java.io.IOException</pre>
<div class="block">Encrypts the entire byte array and streams it to the output file.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>bytes</code> - The byte array to encrypt and write to file.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The number of bytes written to the file. This may be less than the number of bytes
 in the input (or even 0) if the current cipher block has empty space available.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - Thrown if the <code>#prepare(byte[]...)</code> method has not been
 called prior to calling this method.</dd>
<dd><code>java.io.IOException</code> - Thrown if a IO error occurred while writing the encrypted data to the
 output file.</dd>
</dl>
</li>
</ul>
<a name="encryptBytes-java.nio.ByteBuffer-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>encryptBytes</h4>
<pre>public&nbsp;int&nbsp;encryptBytes(@NotNull
                        java.nio.ByteBuffer&nbsp;buffer)
                 throws java.io.IOException</pre>
<div class="block">Encrypts the provided <code>ByteBuffer</code> and streams it to the output file.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>buffer</code> - The buffer to encrypt.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The number of bytes written to the file. This may be less than the number of bytes
 in the input if the current cipher block has empty space available.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - Thrown if the <code>#prepare(byte[]...)</code> method has not been
 called prior to calling this method.</dd>
<dd><code>java.io.IOException</code> - Thrown if a IO error occurred while writing the encrypted data to the
 output file.</dd>
<dd><code>java.lang.NullPointerException</code> - Thrown if the input buffer is null.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/HybridFileEncryptionStream.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/intel/fightclub/encryption/encrypt/HybridFileEncryptionStream.html" target="_top">Frames</a></li>
<li><a href="HybridFileEncryptionStream.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
